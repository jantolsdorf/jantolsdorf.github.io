import{r as t,h as e}from"./p-a0a329c6.js";import{b as s,E as a}from"./p-fd454fec.js";import{f as i}from"./p-22de27ed.js";import{s as o}from"./p-fbf9cfd5.js";import"./p-fd76076a.js";import{g as n}from"./p-59e1f273.js";import{D as l,s as r,i as c,a as d,b as h,r as u,d as p,c as g,U as f,l as m,I as v}from"./p-76a5b83d.js";import{s as b}from"./p-3ca5d941.js";import{C as w}from"./p-1b0a7c96.js";import{l as _}from"./p-98a3b9a5.js";const x={TopStart:"TopStart",TopCenter:"TopCenter",TopEnd:"TopEnd",MiddleStart:"MiddleStart",MiddleCenter:"MiddleCenter",MiddleEnd:"MiddleEnd",BottomStart:"BottomStart",BottomCenter:"BottomCenter",BottomEnd:"BottomEnd"};class y extends l{static isValid(t){return!!x[t]}}y.generateTypeAccessors(x);const D=(t,e,s)=>(d(e),h(s),(t=>r`<div class="ui5-toast-root" role="alert" style="${b(t.styles.root)}" dir="${c(t.effectiveDir)}" @mouseover="${t._onmouseover}" @mouseleave="${t._onmouseleave}" @transitionend="${t._ontransitionend}"><bdi><slot></slot></bdi></div>`)(t));u("@ui5/webcomponents-theme-base","sap_fiori_3",(()=>p)),u("@ui5/webcomponents","sap_fiori_3",(()=>g));const k={tag:"ui5-toast",properties:{duration:{type:v,defaultValue:3e3},placement:{type:y,defaultValue:y.BottomCenter},open:{type:Boolean},hover:{type:Boolean}},slots:{default:{type:Node}}};(class extends f{static get metadata(){return k}static get render(){return m}static get styles(){return':host{font-family:"72override",var(--sapFontFamily);color:var(--sapTextColor);font-size:var(--sapFontSize)}:host([open]) .ui5-toast-root{display:block}.ui5-toast-root{position:fixed;display:none;box-sizing:border-box;max-width:15rem;overflow:hidden;padding:1rem;background:var(--_ui5_toast_background);box-shadow:var(--_ui5_toast_shadow);border-radius:.25rem;transition-property:opacity;opacity:1;font-family:inherit;color:inherit;font-weight:inherit;font-size:inherit;word-wrap:break-word;text-align:center;text-overflow:ellipsis;white-space:pre-line}@media screen and (-ms-high-contrast:active){.ui5-toast-root{border:1px solid var(--sapPageFooter_BorderColor)}}:host(:not([placement])) .ui5-toast-root{bottom:var(--_ui5_toast_vertical_offset);left:50%;transform:translateX(-50%)}:host([placement=TopStart]) .ui5-toast-root{top:var(--_ui5_toast_vertical_offset);left:var(--_ui5_toast_horizontal_offset)}:host([placement=MiddleStart]) .ui5-toast-root{left:var(--_ui5_toast_horizontal_offset);top:50%;transform:translateY(-50%)}:host([placement=BottomStart]) .ui5-toast-root{left:var(--_ui5_toast_horizontal_offset);bottom:var(--_ui5_toast_vertical_offset)}:host([placement=TopCenter]) .ui5-toast-root{top:var(--_ui5_toast_vertical_offset);left:50%;transform:translateX(-50%)}:host([placement=MiddleCenter]) .ui5-toast-root{left:50%;top:50%;transform:translate(-50%,-50%)}:host([placement=BottomCenter]) .ui5-toast-root{bottom:var(--_ui5_toast_vertical_offset);left:50%;transform:translateX(-50%)}:host([placement=TopEnd]) .ui5-toast-root{right:var(--_ui5_toast_horizontal_offset);top:var(--_ui5_toast_vertical_offset)}:host([placement=MiddleEnd]) .ui5-toast-root{right:var(--_ui5_toast_horizontal_offset);top:50%;transform:translateY(-50%)}:host([placement=BottomEnd]) .ui5-toast-root{right:var(--_ui5_toast_horizontal_offset);bottom:var(--_ui5_toast_vertical_offset)}'}static get template(){return D}onAfterRendering(){this._reopen&&(this._reopen=!1,this._initiateOpening())}show(){this.open?(this._reopen=!0,this.open=!1):this._initiateOpening()}get effectiveDuration(){return this.duration<500?500:this.duration}get styles(){const t=Math.min(this.effectiveDuration/3,1e3);return{root:{"transition-duration":this.open?`${t}ms`:"","transition-delay":this.open?this.effectiveDuration-t+"ms":"",opacity:this.open&&!this.hover?"0":"","z-index":n()}}}_initiateOpening(){requestAnimationFrame((()=>{this.open=!0}))}_ontransitionend(){this.hover||(this.open=!1)}_onmouseover(){this.hover=!0}_onmouseleave(){this.hover=!1}}).define();const j=class{constructor(e){t(this,e),this.baseUrl="",this.formWidgetOutdatedData=0,this.formTabPaneState="PERSONAL_DATA",this.formMessageNew=""}getDataSet(){return this.dataBasket.dataSets.forEach((t=>{t.pii.forEach((t=>{t.data_consent=_.labelNotAvailable,t.data_delete_date="2023-01-01",t.data_source=_.labelUnkown,t.data_last_change=new Date("August 19, 1975 23:15:30")}))})),this.dataBasket.dataSets}getActuality(){var t="latest";return this.dataBasket.dataSets.forEach((e=>{e.pii.forEach((e=>{t=e.data_last_change.toString()}))})),t}getDeleteDate(){var t="never";return this.getDataSet().forEach((e=>{e.pii.forEach((e=>{"never"==t?"never"!=e.data_delete_date&&(t=e.data_delete_date):e.data_delete_date<t&&(t=e.data_delete_date)}))})),t}countData(){var t=0;return this.dataBasket.dataSets.forEach((e=>{e.pii.forEach((()=>{t++}))})),t}componentWillLoad(){this.dataBasket||(this.dataBasket=o.importedFromForm,this.dataBasket||console.log("Error: no data basket")),this.dataBasket.dataSets.map((t=>{"OUTDATED"===s.checkOutdatedPII(this.dataBasket,t)&&this.formWidgetOutdatedData>-1?this.formWidgetOutdatedData+=1:"UNKNOWN"===s.checkOutdatedPII(this.dataBasket,t)&&(this.formWidgetOutdatedData=-1)}))}componentWillRender(){}componentDidLoad(){}componentDidRender(){$("[data-toggle='tooltip']").tooltip(),console.log(this.dataBasket)}render(){return e("div",{class:"container"},this.dataBasket.status===a.DRAFTING?e("div",{class:"row p-2 mt-3"},e("div",{class:"col-12"},e("ui5-messagestrip",{type:"Warning","no-close-button":!0},e("b",null,_.labelInProgress," .")," ",_.labelDataBasketNotActive),e("diV",null))):"",e("div",{class:"row p-2 mt-3 bg-white rounded border"},e("div",{class:"col-12"},e("label",{class:"lead"},"Ausgewählte Verarbeitungstätigkeit"),e("div",{class:"row",hidden:!0},e("ui5-radiobutton",{text:"Standard (bereits genehmigte Zwecke)",selected:!this.dataBasket.isNewProcessingRecordEntry,onSelect:()=>this.dataBasket=Object.assign(Object.assign({},this.dataBasket),{isNewProcessingRecordEntry:!1}),name:"GroupPurposeSelection"}),e("ui5-radiobutton",{text:"Neuer Zweck oder Zweck selbst festlegen",selected:this.dataBasket.isNewProcessingRecordEntry,onSelect:()=>this.dataBasket=Object.assign(Object.assign({},this.dataBasket),{isNewProcessingRecordEntry:!0}),name:"GroupPurposeSelection"})),e("div",null,this.dataBasket.isNewProcessingRecordEntry?e("ui5-messagestrip",{type:"Information","no-icon":!0,"no-close-button":!0},e("p",null,e("b",null,"Hinweis")),"Neue Zwecke müssen durch den Datenschutzbeauftragten geprüft und genehmigt werden. Sie sollten diese Option daher nur wählen, wenn Ihre geplante Verarbeitungsaktivität noch nicht im Verzeichnis hinterlegt ist."):""===this.dataBasket.selectedProcessingRecordID?e("div",{class:"col-12 card-block text-center trusd-button-select",onClick:()=>document.getElementsByTagName("trusd-com-modal-window").item(0).toggleAttribute("open")},e("div",{class:"file text-center align-middle"},e("p",null),e("span",{class:"text-primary"},e("i",{class:"fas fa-hand-pointer"}),"  Zweck oder Grundlage auswählen"),e("p",null))):e("div",{class:"row"},e("div",{class:"col"},e("ui5-list",{mode:"Delete"},e("ui5-li",{class:"col-12",selected:!0,description:i(this.dataBasket.selectedProcessingRecordID).purposes.map((t=>" "+t.displayName))},i(this.dataBasket.selectedProcessingRecordID).friendlyName))),e("div",{class:"d-flex align-items-center justify-content-center"},e("span",{class:"fas fa-check-circle text-success"})))))),e("div",{class:"row p-2 mt-3 bg-white rounded border"},e("div",{class:"col-12"},e("label",{class:"lead"},"Name der geplanten Datenverarbeitungstätigkeit"),e("div",{class:"row"},e("div",{class:"col"},e("input",{type:"text",class:"form-control",value:this.dataBasket.title,onInput:t=>this.dataBasket=Object.assign(Object.assign({},this.dataBasket),{title:t.target.value}),placeholder:"z. B.: Abschlussbericht, Forschungsantrag Projekt, Einstellung Frau Freudscheidt, ..."})),""!==this.dataBasket.title?e("div",{class:"d-flex align-items-center justify-content-center"},e("span",{class:"fas fa-check-circle text-success"})):""))),e("div",{class:"row p-2 mt-3 bg-white rounded border"},e("div",{class:"col-12"},e("label",{class:"lead"},"Beschreibung des Zwecks der geplanten Datenverarbeitungsaktivität"),e("div",{class:"row"},e("div",{class:"col"},e("textarea",{id:"description",class:"form-control","aria-label":"With textarea",value:this.dataBasket.description,onInput:t=>this.dataBasket=Object.assign(Object.assign({},this.dataBasket),{description:t.target.value}),placeholder:"z. B.: Erstellen und Verwalten der Teilnehmerliste für die Veranstaltung am Donnerstag."})),""!==this.dataBasket.description?e("div",{class:"d-flex align-items-center justify-content-center"},e("span",{class:"fas fa-check-circle text-success"})):""))),e("div",{class:"row p-2 mt-3 bg-white rounded border"},e("div",{class:"col-12"},e("label",{class:"lead"},"Betroffene Personen und personenbezogene Daten "),"SELF"===this.dataBasket.requestDataRequestedFrom?"":e("div",{class:"col-12"},e("div",{class:"row w-100 pt-3"},e("div",{class:"col ml-3 p-1 border rounded cursor-help"},this.dataBasket.progressCompletenessPersonalData<100&&"DATA_SUBJECT"===this.dataBasket.requestDataRequestedFrom?e("div",{"data-toggle":"tooltip","data-placement":"bottom",title:"Die angefragten Daten sind erst zu "+this.dataBasket.progressCompletenessPersonalData+"% vollständig."},e("div",{class:"row ml-0"},e("div",{class:"col-3"},e("div",{style:{width:"50px"}},e("trusd-com-circle-progress-bar-small",{Type:"percent",ProgressMax:100,ProgressCurrent:this.dataBasket.progressCompletenessPersonalData}))),e("div",{class:"col-9 text-center"},e("h6",{class:"font-weight-light"},"Datenvollständigkeit:"),e("small",{class:"badge badge-warning "},"unvollständig")))):this.dataBasket.progressCompletenessPersonalData<100&&100==this.dataBasket.progressCompletenessPersonalDataOtherDepartment?e("div",{"data-toggle":"tooltip","data-placement":"bottom",title:"Alle angefragten Daten stehen in einer anderen Abteilung zur Verfügung und werden Ihnen zur Verfügung gestellt."},e("div",{class:"row ml-0"},e("div",{class:"col-3"},e("div",{style:{width:"50px"}},e("trusd-com-circle-progress-bar-small",{ProgressColor:"#dc3545",Type:"percent",ProgressMax:100,ProgressCurrent:this.dataBasket.progressCompletenessPersonalData}))),e("div",{class:"col-9 text-center"},e("h6",{class:"font-weight-light"},"Datenvollständigkeit:"),e("small",{class:"badge badge-warning"},"unvollständig")," ",e("small",{class:"badge badge-success "},"vorrätig")))):e("div",{"data-toggle":"tooltip","data-placement":"bottom",title:"Alle angefragten Daten sind vollständig und stehen Ihnen sofort zur Verfügung."},e("div",{class:"row ml-0"},e("div",{class:"col-3"},e("div",{style:{width:"50px"}},e("trusd-com-circle-progress-bar-small",{Type:"percent",ProgressMax:100,ProgressCurrent:this.dataBasket.progressCompletenessPersonalData}))),e("div",{class:"col-9"},e("h6",{class:"font-weight-light m-0"},"Datenvollständigkeit:"),e("small",{class:"font-weight-light"},"vollständig"))))),"DATA_SUBJECT"===this.dataBasket.requestDataRequestedFrom||"FROM_OTHER"===this.dataBasket.requestDataRequestedFrom?e("div",{class:"col ml-3 p-1 border rounded cursor-help"},e("div",{"data-toggle":"tooltip","data-placement":"bottom",title:"Sie haben die Daten bei"+("DATA_SUBJECT"===this.dataBasket.requestDataRequestedFrom?" den betroffenen Personen angefragt":" einer Abteilung oder bestimmten Person angefragt")},e("div",{class:"row ml-0"},e("div",{class:"col-3"},e("div",{class:"d-flex align-items-center justify-content-center text-secondary h-100"},e("i",{class:"fas fa-user-friends fa-2x"}))),e("div",{class:"col-9"},e("h6",{class:"font-weight-light m-0"},"Anfragen bei:"),"DATA_SUBJECT"===this.dataBasket.requestDataRequestedFrom?e("small",{class:"font-weight-light"},"betroffene Personen"):e("small",{class:"font-weight-light",style:{lineHeight:"90%"}},this.dataBasket.dataSourcePersonOrDepartment.last_name+", "+this.dataBasket.dataSourcePersonOrDepartment.first_name))))):"",e("div",{class:"flex-column d-flex ml-3 p-1 border rounded cursor-help"},-1==this.formWidgetOutdatedData?e("div",{"data-toggle":"tooltip","data-placement":"bottom",title:"Die Aktualität der Daten konnte nicht ermittelt werden."},e("div",{class:"row ml-0"},e("div",{class:"col-3"},e("div",{class:"d-flex align-items-center justify-content-center text-secondary h-100"},e("i",{class:"far fa-calendar-times fa-2x"}))),e("div",{class:"col-9"},e("h6",{class:"font-weight-light m-0"},"Datenaktualität:"),e("small",{class:"font-weight-light"},"unbekannt")))):this.formWidgetOutdatedData>0?e("div",{"data-toggle":"tooltip","data-placement":"bottom",title:"Bei "+this.formWidgetOutdatedData+" Person(en) sind die verfügbaren personenbezogenen Daten eventuell veraltet."},e("div",{class:"row ml-0"},e("div",{class:"col-3"},e("div",{class:"d-flex align-items-center justify-content-center text-secondary h-100"},e("i",{class:"far fa-calendar-times fa-2x"}))),e("div",{class:"col-9"},e("h6",{class:"font-weight-light m-0"},"Datenaktualität:"),e("small",{class:"badge badge-warning"},"älter als 180 Tage")))):e("div",{"data-toggle":"tooltip","data-placement":"bottom",title:"Die personenbezogenen Daten sind aktuell."},e("div",{class:"row ml-0"},e("div",{class:"col-3"},e("div",{class:"d-flex align-items-center justify-content-center text-secondary h-100"},e("i",{class:"fas fa-calendar-check fa-2x"}))),e("div",{class:"col-9"},e("h6",{class:"font-weight-light m-0"},"Datenaktualität:"),e("small",{class:"font-weight-light"},"aktuell"))))),e("div",{class:"col ml-3 p-1 border rounded cursor-help"},e("div",{"data-toggle":"tooltip","data-placement":"bottom",title:"Die von Ihnen angegebene Frist, bis zu der Sie die Daten benötigen."},e("div",{class:"row ml-0"},e("div",{class:"col-3"},e("div",{class:"d-flex align-items-center justify-content-center text-secondary h-100"},e("i",{class:"far fa-calendar-alt fa-2x"}))),e("div",{class:"col-9"},e("h6",{class:"font-weight-light"},"Rückmeldefrist:"),e("small",{class:"font-weight-light"},""!==this.dataBasket.deadline?this.dataBasket.deadline:"Keine Frist festgelgt"))))))),"DATA_SUBJECT"===this.dataBasket.requestDataRequestedFrom||"FROM_OTHER"===this.dataBasket.requestDataRequestedFrom?e("div",null,"DATA_SUBJECT"===this.dataBasket.requestDataRequestedFrom?e("div",{class:"row p-2 mt-3 bg-white rounded border"},e("div",{class:"col-12"},e("label",{class:"lead"},"Persönliche Nachricht an die ",e("b",null,"betroffenen Personen")," (optional):"),e("div",{class:"row"},e("div",{class:"col"},e("textarea",{id:"description",class:"form-control","aria-label":"With textarea",value:this.dataBasket.requestPersonalMessageToDataSubjects,onInput:t=>this.dataBasket=Object.assign(Object.assign({},this.dataBasket),{requestPersonalMessageToDataSubjects:t.target.value})})),this.dataBasket.requestPersonalMessageToDataSubjects&&""!==this.dataBasket.requestPersonalMessageToDataSubjects?e("div",{class:"d-flex align-items-center justify-content-center"},e("span",{class:"fas fa-check-circle text-success"})):""))):"FROM_OTHER"===this.dataBasket.requestDataRequestedFrom?e("div",{class:"row p-2 mt-3 bg-white rounded border"},e("div",{class:"col-12"},e("label",{class:"lead"},"Persönliche Nachricht an die ausgewählte ",e("b",null,"Kontaktperson oder Abteilung")," (optional):"),e("div",{class:"row"},e("div",{class:"col"},e("textarea",{id:"description",class:"form-control","aria-label":"With textarea",value:this.dataBasket.requestPersonalMessageToPersonOrDepartment,onInput:t=>this.dataBasket=Object.assign(Object.assign({},this.dataBasket),{requestPersonalMessageToPersonOrDepartment:t.target.value})})),this.dataBasket.requestPersonalMessageToPersonOrDepartment&&""!==this.dataBasket.requestPersonalMessageToPersonOrDepartment?e("div",{class:"d-flex align-items-center justify-content-center"},e("span",{class:"fas fa-check-circle text-success"})):""))):""):"",e("div",{class:"col-12 pt-3"},e("hr",{class:"bg-primary"})),e("div",{class:"col-12 pt-3"},e("details",{open:!0},e("summary",{class:"pl-2 btn-outline-primary border rounded"},this.dataBasket.dataSets.length," betroffene Person(en) anzeigen"),this.dataBasket.dataSets.length>0?e("div",{class:"row p-3 m-0 bg-light overflow-auto",style:{maxHeight:"400px"}},e("trusd-piiq-com-data-basket-data-subject-list",{class:"w-100",hideSendMessage:!0,dataBasket:this.dataBasket})):e("div",{class:"row"},e("div",{class:"col-3"}),e("div",{class:"col-6"},e("p",{class:"text-center font-italic w-100"},"Bitte wählen Sie oben die personenbezogenen Daten und die betroffenen Personen aus und fügen Sie Ihre Auswahl anschließend dem Datenkorb hinzu.")),e("div",{class:"col-3"})))))),this.dataBasket.status===a.DRAFTING?e("div",{class:"row d-flex justify-content-end"},e("div",{class:"p-2"},e("button",{type:"button",class:"btn btn-outline-danger ",onClick:()=>o.dbEDataBasket=[...o.dbEDataBasket.filter((t=>t.ID!==this.dataBasket.ID))]},"Verwerfen")),e("div",{class:"p-2"},e("button",{type:"button",class:"btn btn-outline-primary",onClick:()=>{this.dataBasket=Object.assign(Object.assign({},this.dataBasket),{status:a.DRAFTING}),this.dataBasket=s.updateProgress(this.dataBasket),o.dbEDataBasket=[...o.dbEDataBasket.filter((t=>t.ID!==this.dataBasket.ID)),this.dataBasket],document.getElementById("toast-data-basket-import-save-draft").show()}},"Als Entwurf Speichern")),e("ui5-toast",{id:"toast-data-basket-import-save-draft"},e("ui5-messagestrip",{type:"Positive","no-close-button":!0},e("b",null,"Gespeichert!"))),e("div",{class:"p-2"},e("button",{type:"button",class:"btn btn-success",onClick:()=>{this.dataBasket=Object.assign(Object.assign({},this.dataBasket),{status:a.ACTIVE}),this.dataBasket=s.updateProgress(this.dataBasket),o.dbEDataBasket=[...o.dbEDataBasket.filter((t=>t.ID!==this.dataBasket.ID)),this.dataBasket],window.location.href=o.baseURL+w.route+"/"+this.dataBasket.ID}},this.dataBasket.ID.startsWith("d003b03f")?e("span",null,"Personenbezogene Daten erfassen"):e("span",null,e("i",{class:"fas fa-paper-plane"})," Anfragen versenden und Datenkorb aktivieren")))):"")}};j.route="/vorlagen/datenkorb/import",j.style="";export{j as D}